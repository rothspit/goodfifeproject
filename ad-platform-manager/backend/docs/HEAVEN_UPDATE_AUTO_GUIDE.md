# ğŸ“ ã‚¢ã‚¤ãƒ‰ãƒ«å­¦åœ’ - ãƒ˜ãƒ–ãƒ³æ›´æ–°è‡ªå‹•å®Ÿè¡Œã‚·ã‚¹ãƒ†ãƒ 

**ä½œæˆæ—¥**: 2025-12-25  
**åº—èˆ—**: ã‚¢ã‚¤ãƒ‰ãƒ«å­¦åœ’ï¼ˆåº—èˆ—ID: 2510055906ï¼‰

---

## ğŸ“‹ æ©Ÿèƒ½æ¦‚è¦

### âœ… ä¸»ãªæ©Ÿèƒ½
1. **ãƒ˜ãƒ–ãƒ³æ›´æ–°ãƒœã‚¿ãƒ³ã®è‡ªå‹•ã‚¯ãƒªãƒƒã‚¯**
2. **æ®‹ã‚Šå›æ•°ã®è‡ªå‹•ã‚«ã‚¦ãƒ³ãƒˆ** (æ¯å›ç¢ºèª)
3. **ã‚¿ã‚¤ãƒãƒ¼è¨­å®š** (å®šæœŸè‡ªå‹•å®Ÿè¡Œ)
4. **å®Ÿè¡Œãƒ­ã‚°ã®è¨˜éŒ²** (JSONå½¢å¼)
5. **ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆè‡ªå‹•ä¿å­˜**

---

## ğŸš€ ä½¿ã„æ–¹

### 1å›ã ã‘å®Ÿè¡Œ

```bash
cd /home/user/webapp/ad-platform-manager/backend
npx ts-node heaven-update-auto.ts
```

**å®Ÿè¡Œçµæœä¾‹**:
```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  ğŸ“ ã‚¢ã‚¤ãƒ‰ãƒ«å­¦åœ’ - ãƒ˜ãƒ–ãƒ³æ›´æ–°å®Ÿè¡Œ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â° å®Ÿè¡Œæ™‚åˆ»: 2025/12/25 20:57:39

âœ… ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ
ğŸ“Š å®Ÿè¡Œå‰ã®æ®‹ã‚Šå›æ•°: 16/16å›
ğŸ”„ ãƒ˜ãƒ–ãƒ³æ›´æ–°ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ä¸­...
ğŸ“Š å®Ÿè¡Œå¾Œã®æ®‹ã‚Šå›æ•°: 16/16å›
ğŸ“¸ ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆä¿å­˜å®Œäº†

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… æ›´æ–°æˆåŠŸ
ğŸ“Š æ›´æ–°æˆåŠŸï¼ˆæ®‹ã‚Š16/16å›ï¼‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

---

### ã‚¿ã‚¤ãƒãƒ¼ãƒ¢ãƒ¼ãƒ‰ï¼ˆå®šæœŸè‡ªå‹•å®Ÿè¡Œï¼‰

#### åŸºæœ¬ï¼ˆ30åˆ†é–“éš”ã§ç„¡åˆ¶é™å®Ÿè¡Œï¼‰
```bash
npx ts-node heaven-update-auto.ts --timer
```

#### ã‚«ã‚¹ã‚¿ãƒ é–“éš”ï¼ˆ10åˆ†é–“éš”ï¼‰
```bash
npx ts-node heaven-update-auto.ts --timer --interval 10
```

#### æœ€å¤§å®Ÿè¡Œå›æ•°æŒ‡å®šï¼ˆ5å›ã¾ã§ã€30åˆ†é–“éš”ï¼‰
```bash
npx ts-node heaven-update-auto.ts --timer --interval 30 --max-runs 5
```

#### åœæ­¢æ–¹æ³•
ã‚¿ã‚¤ãƒãƒ¼ãƒ¢ãƒ¼ãƒ‰å®Ÿè¡Œä¸­ã¯ `Ctrl+C` ã§åœæ­¢

---

## ğŸ“Š ã‚ªãƒ—ã‚·ãƒ§ãƒ³ä¸€è¦§

| ã‚ªãƒ—ã‚·ãƒ§ãƒ³ | èª¬æ˜ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ | ä¾‹ |
|-----------|------|------------|-----|
| `--timer` | ã‚¿ã‚¤ãƒãƒ¼ãƒ¢ãƒ¼ãƒ‰æœ‰åŠ¹åŒ– | - | `--timer` |
| `--interval <åˆ†>` | å®Ÿè¡Œé–“éš”ï¼ˆåˆ†ï¼‰ | 30åˆ† | `--interval 10` |
| `--max-runs <å›>` | æœ€å¤§å®Ÿè¡Œå›æ•° | ç„¡åˆ¶é™ | `--max-runs 5` |

---

## ğŸ“ ä¿å­˜ã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«

### å®Ÿè¡Œãƒ­ã‚°
```
logs/heaven-update-log.json
```

**ãƒ­ã‚°å½¢å¼**:
```json
[
  {
    "success": true,
    "remainingCount": 16,
    "totalCount": 16,
    "timestamp": "2025-12-25T20:57:51.182Z",
    "message": "æ›´æ–°æˆåŠŸï¼ˆæ®‹ã‚Š16/16å›ï¼‰"
  }
]
```

### ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
```
screenshots/heaven-update-<timestamp>.png
```

å®Ÿè¡Œæ™‚ã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ç”»é¢ãŒè‡ªå‹•ä¿å­˜ã•ã‚Œã¾ã™ã€‚

---

## ğŸ”§ PM2ã§å¸¸é§å®Ÿè¡Œï¼ˆæ¨å¥¨ï¼‰

### PM2è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ

`ecosystem.config.js` ã«ä»¥ä¸‹ã‚’è¿½åŠ :

```javascript
module.exports = {
  apps: [
    {
      name: 'idol-heaven-updater',
      script: 'npx',
      args: 'ts-node heaven-update-auto.ts --timer --interval 30',
      cwd: '/home/user/webapp/ad-platform-manager/backend',
      instances: 1,
      autorestart: true,
      watch: false,
      max_memory_restart: '1G',
      error_file: './logs/idol-heaven-error.log',
      out_file: './logs/idol-heaven-out.log',
      log_file: './logs/idol-heaven-combined.log',
      time: true,
      env: {
        NODE_ENV: 'production'
      }
    }
  ]
};
```

### PM2ã‚³ãƒãƒ³ãƒ‰

```bash
# é–‹å§‹
pm2 start ecosystem.config.js --only idol-heaven-updater

# çŠ¶æ…‹ç¢ºèª
pm2 status idol-heaven-updater

# ãƒ­ã‚°ç¢ºèª
pm2 logs idol-heaven-updater

# åœæ­¢
pm2 stop idol-heaven-updater

# å†èµ·å‹•
pm2 restart idol-heaven-updater

# å‰Šé™¤
pm2 delete idol-heaven-updater
```

---

## ğŸ¯ å®Ÿè¡Œã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä¾‹

### ä¾‹1: å¹³æ—¥ã®å–¶æ¥­æ™‚é–“ã®ã¿å®Ÿè¡Œ
```bash
# cronã§å¹³æ—¥10:00-22:00ã®ã¿å®Ÿè¡Œ
0 10-22 * * 1-5 cd /path/to/backend && npx ts-node heaven-update-auto.ts
```

### ä¾‹2: æ¯æ—¥30åˆ†é–“éš”ã§å®Ÿè¡Œ
```bash
# PM2ã§24æ™‚é–“ç¨¼åƒ
pm2 start heaven-update-auto.ts --name idol-updater -- --timer --interval 30
```

### ä¾‹3: 1æ—¥5å›ã¾ã§
```bash
# æœ€å¤§5å›å®Ÿè¡Œã€6æ™‚é–“é–“éš”
npx ts-node heaven-update-auto.ts --timer --interval 360 --max-runs 5
```

---

## ğŸ“Š ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆ

### ãƒ­ã‚°ç›£è¦–ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

```bash
#!/bin/bash
# check-heaven-update.sh

LOG_FILE="logs/heaven-update-log.json"
LAST_SUCCESS=$(jq -r '.[-1].success' $LOG_FILE)

if [ "$LAST_SUCCESS" = "false" ]; then
  echo "âš ï¸  ãƒ˜ãƒ–ãƒ³æ›´æ–°å¤±æ•—ã‚’æ¤œçŸ¥"
  # Slackãªã©ã«é€šçŸ¥
  # curl -X POST -H 'Content-type: application/json' \
  #   --data '{"text":"ã‚¢ã‚¤ãƒ‰ãƒ«å­¦åœ’ã®ãƒ˜ãƒ–ãƒ³æ›´æ–°ãŒå¤±æ•—ã—ã¾ã—ãŸ"}' \
  #   YOUR_SLACK_WEBHOOK_URL
fi
```

---

## ğŸ” ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### Q: ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—ã™ã‚‹
**A**: èªè¨¼æƒ…å ±ã‚’ç¢ºèª
```typescript
// heaven-update-auto.ts ã® credentials ã‚’ç¢ºèª
private readonly credentials = {
  username: '2510055906',
  password: 'OgI70vnH'
};
```

### Q: æ®‹ã‚Šå›æ•°ãŒå–å¾—ã§ããªã„
**A**: ãƒšãƒ¼ã‚¸æ§‹é€ ãŒå¤‰ã‚ã£ãŸå¯èƒ½æ€§
- `screenshots/` ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’ç¢ºèª
- ãƒœã‚¿ãƒ³ã®ãƒ†ã‚­ã‚¹ãƒˆãŒã€Œæ®‹ã‚Šâ—‹/â—‹å›ã€ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèª

### Q: ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã§ããªã„
**A**: ã‚»ãƒ¬ã‚¯ã‚¿ã‚’ç¢ºèª
```typescript
// ç¾åœ¨ã®ã‚»ãƒ¬ã‚¯ã‚¿
const updateButton = this.page.locator('a.manager-list:has-text("æ›´æ–°ãƒœã‚¿ãƒ³")').first();
```

### Q: ã‚¿ã‚¤ãƒãƒ¼ãŒåœæ­¢ã—ãªã„
**A**: `Ctrl+C` ã‚’æŠ¼ã™ã€ã¾ãŸã¯ãƒ—ãƒ­ã‚»ã‚¹ã‚’å¼·åˆ¶çµ‚äº†
```bash
pkill -f "heaven-update-auto"
```

---

## ğŸ“ˆ å®Ÿè¡Œçµ±è¨ˆ

### ãƒ­ã‚°ã‹ã‚‰çµ±è¨ˆã‚’å–å¾—

```bash
# æˆåŠŸç‡ã‚’è¨ˆç®—
cat logs/heaven-update-log.json | jq '[.[] | .success] | add / length * 100'

# æœ€æ–°10ä»¶ã®å®Ÿè¡Œçµæœ
cat logs/heaven-update-log.json | jq '.[-10:]'

# æ®‹ã‚Šå›æ•°ã®æ¨ç§»
cat logs/heaven-update-log.json | jq '.[] | {timestamp, remaining: .remainingCount}'
```

---

## ğŸ¯ æ¨å¥¨è¨­å®š

### æœ¬ç•ªç’°å¢ƒ
- **å®Ÿè¡Œé–“éš”**: 30åˆ†
- **å®Ÿè¡Œæ–¹æ³•**: PM2ã§å¸¸é§
- **ãƒ­ã‚°ä¿æŒ**: æœ€æ–°100ä»¶
- **ã‚¨ãƒ©ãƒ¼é€šçŸ¥**: Slack/ãƒ¡ãƒ¼ãƒ«

### ãƒ†ã‚¹ãƒˆç’°å¢ƒ
- **å®Ÿè¡Œé–“éš”**: 10åˆ†
- **æœ€å¤§å®Ÿè¡Œå›æ•°**: 5å›
- **ãƒ­ã‚°ç¢ºèª**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ 

---

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

### ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§
- **ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**: `heaven-update-auto.ts`
- **ãƒœã‚¿ãƒ³æ¢ç´¢**: `find-heaven-update-button.ts`
- **å®Ÿè¡Œãƒ­ã‚°**: `logs/heaven-update-log.json`
- **ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ**: `screenshots/heaven-update-*.png`

### é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- ã‚·ãƒ†ã‚£ãƒ˜ãƒ–ãƒ³ãƒãƒƒãƒˆå®Ÿè£…: `docs/CITYHEAVEN_MOBILE_API_ANALYSIS.md`
- å…¨ä½“ãƒ¬ãƒãƒ¼ãƒˆ: `/home/user/webapp/FINAL_PROJECT_REPORT.md`

---

## âœ… ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

å®Ÿè¡Œå‰ã«ç¢ºèªï¼š

- [ ] èªè¨¼æƒ…å ±ãŒæ­£ã—ã„ã‹
- [ ] ãƒ­ã‚°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå­˜åœ¨ã™ã‚‹ã‹ (`mkdir -p logs`)
- [ ] ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå­˜åœ¨ã™ã‚‹ã‹ (`mkdir -p screenshots`)
- [ ] PlaywrightãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ (`npx playwright install`)
- [ ] ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ãŒæ­£ã—ã„ã‹ï¼ˆJST: Asia/Tokyoï¼‰

---

**æœ€çµ‚æ›´æ–°**: 2025-12-25  
**ä½œæˆè€…**: AIé–‹ç™ºã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… ãƒ†ã‚¹ãƒˆå®Œäº†ãƒ»æœ¬ç•ªåˆ©ç”¨å¯èƒ½
